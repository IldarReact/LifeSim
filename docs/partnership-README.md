# –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏–º–∏ –±–∏–∑–Ω–µ—Å–∞–º–∏

## üéØ –ß—Ç–æ —ç—Ç–æ?

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏–º–∏ –±–∏–∑–Ω–µ—Å–∞–º–∏ –≤ –º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä–µ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ Liveblocks.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üîê –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ–ª–∏ –≤–ª–∞–¥–µ–Ω–∏—è

- **> 50%** - –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å, –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- **= 50%** - –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Ç–Ω—ë—Ä–∞ –¥–ª—è –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **< 50%** - –¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä, –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–µ—â–µ–Ω—ã

### üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –º–µ–∂–¥—É –∏–≥—Ä–æ–∫–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
- –ù–∞–π–º/—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
- –ó–∞–º–æ—Ä–æ–∑–∫–∞/—Ä–∞–∑–º–æ—Ä–æ–∑–∫–∞ –±–∏–∑–Ω–µ—Å–∞

### üìã –°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π

–ü—Ä–∏ —Ä–∞–≤–Ω—ã—Ö –¥–æ–ª—è—Ö (50/50):
1. –ò–≥—Ä–æ–∫ 1 –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ
2. –ò–≥—Ä–æ–∫ 2 –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
3. –ò–≥—Ä–æ–∫ 2 –æ–¥–æ–±—Ä—è–µ—Ç –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç
4. –ü—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ –æ–±–æ–∏–º

### üé® –ì–æ—Ç–æ–≤—ã–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- `BusinessControls` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å–æ–º —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø—Ä–∞–≤
- `BusinessProposals` - —Å–ø–∏—Å–æ–∫ –≤—Ö–æ–¥—è—â–∏—Ö/–∏—Å—Ö–æ–¥—è—â–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤

```typescript
import { canMakeDirectChanges, getPlayerShare } from '@/core/lib/business/partnership-permissions'

const share = getPlayerShare(business, player.id)
const canControl = canMakeDirectChanges(business, player.id)

if (canControl) {
  // –ú–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å –Ω–∞–ø—Ä—è–º—É—é
} else if (share === 50) {
  // –ù—É–∂–Ω–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ
} else {
  // –¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä
}
```

### 2. –í–Ω–µ—Å–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```typescript
const updateDirect = useGameStore(state => state.updateBusinessDirectly)
const propose = useGameStore(state => state.proposeBusinessChange)

if (canMakeDirectChanges(business, player.id)) {
  updateDirect(businessId, { price: 150 })
} else {
  propose(businessId, 'price', { newPrice: 150 })
}
```

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π

```typescript
const approve = useGameStore(state => state.approveBusinessChange)
const reject = useGameStore(state => state.rejectBusinessChange)

approve(proposalId) // –û–¥–æ–±—Ä–∏—Ç—å
reject(proposalId)  // –û—Ç–∫–ª–æ–Ω–∏—Ç—å
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[Quick Start](./partnership-quick-start.md)** - –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **[Architecture](./partnership-architecture.md)** - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- **[Full Documentation](./partnership-business-system.md)** - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
UI Layer
  ‚Üì
Store Layer (partnership-business-slice)
  ‚Üì
Multiplayer Layer (game-store)
  ‚Üì
Liveblocks (real-time sync)
```

## üì¶ –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ

### –¢–∏–ø—ã
- `BusinessChangeType` - —Ç–∏–ø—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `BusinessChangeProposal` - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
- –°–æ–±—ã—Ç–∏—è: `BUSINESS_CHANGE_PROPOSED`, `BUSINESS_CHANGE_APPROVED`, `BUSINESS_UPDATED`

### –£—Ç–∏–ª–∏—Ç—ã
- `canMakeDirectChanges()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ > 50%
- `requiresApproval()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ = 50%
- `getPlayerShare()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ–ª–∏
- `getBusinessPartner()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä—Ç–Ω—ë—Ä–∞

### Store Actions
- `proposeBusinessChange()` - –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ
- `approveBusinessChange()` - –æ–¥–æ–±—Ä–∏—Ç—å
- `rejectBusinessChange()` - –æ—Ç–∫–ª–æ–Ω–∏—Ç—å
- `updateBusinessDirectly()` - –ø—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ

### Event Handlers
- `onBusinessChangeProposed()` - –ø–æ–ª—É—á–µ–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
- `onBusinessChangeApproved()` - –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ–¥–æ–±—Ä–µ–Ω–æ
- `onBusinessChangeRejected()` - –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ
- `onBusinessUpdated()` - –±–∏–∑–Ω–µ—Å –æ–±–Ω–æ–≤–ª—ë–Ω

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã

```typescript
function handlePriceChange(newPrice: number) {
  const canDirect = canMakeDirectChanges(business, player.id)
  
  if (canDirect) {
    updateBusinessDirectly(businessId, { price: newPrice })
  } else if (requiresApproval(business, player.id)) {
    proposeBusinessChange(businessId, 'price', { newPrice })
  } else {
    alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤')
  }
}
```

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π

```typescript
function ProposalsList() {
  const proposals = useGameStore(state => state.businessProposals)
  const incoming = proposals.filter(p => 
    p.status === 'pending' && p.initiatorId !== player.id
  )

  return incoming.map(proposal => (
    <div key={proposal.id}>
      <p>{proposal.initiatorName} –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å {proposal.changeType}</p>
      <button onClick={() => approve(proposal.id)}>‚úì</button>
      <button onClick={() => reject(proposal.id)}>‚úó</button>
    </div>
  ))
}
```

## üîß –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ

–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–∏–ø –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ:

```typescript
// 1. –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø
export type BusinessChangeType = 
  | 'price'
  | 'your_new_type' // ‚Üê –¥–æ–±–∞–≤–∏—Ç—å

// 2. –†–∞—Å—à–∏—Ä–∏—Ç—å payload
data: {
  newPrice?: number
  yourField?: YourType // ‚Üê –¥–æ–±–∞–≤–∏—Ç—å
}

// 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
proposeBusinessChange(businessId, 'your_new_type', {
  yourField: value
})
```

## ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞—Ä—Ç–Ω—ë—Ä—Å—Ç–≤–æ 50/50
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ü–µ–Ω—É
3. –í—Ç–æ—Ä–æ–π –∏–≥—Ä–æ–∫ –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
4. –û–¥–æ–±—Ä–∏—Ç–µ/–æ—Ç–∫–ª–æ–Ω–∏—Ç–µ
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é

## üé® –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è

–ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –±–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã. –î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ —Å—Ç–∏–ª–∏:

```css
.proposal-card { /* –≤–∞—à–∏ —Å—Ç–∏–ª–∏ */ }
.status-pending { color: orange; }
.status-approved { color: green; }
.status-rejected { color: red; }
```

## ü§ù –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π store –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫. –ü—Ä–æ—Å—Ç–æ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ!

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–ß–∞—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ ArtSurv

---

**–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–≥–æ –º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä–∞**
